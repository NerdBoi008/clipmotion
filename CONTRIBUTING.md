# Contributing to ClipMotion

Thanks for your interest in contributing to **ClipMotion**!  
ClipMotion is a community-driven CLI that turns animations from real-world videos (Instagram, TikTok, YouTube, etc.) into reusable components for web frameworks.

This guide explains how to set up the repo, add new components, and improve the tool.

---

## What You Can Contribute

- New animation components (from reels/videos)
- Better implementations (performance, accessibility, cleanup)
- Support for more frameworks/libraries
- Improvements to the CLI (init/add/find/create/registry:build)
- Documentation, examples, and demos
- Bug fixes and DX improvements

---

## Project Structure

Key folders:

```txt
clipmotion/
├── commands/                 # CLI commands (init, add, find, create,registry-build)
├── registry/                 # Source components for the registry
│   ├── nextjs/
│   │   ├── ui/              # Next.js components
│   │   ├── lib/             # Internal utilities (optional)
│   │   └── hooks/           # Hooks (optional)
│   ├── react/
│   ├── vue/
│   └── angular/
├── public/
│   └── r/                   # Built registry JSON files (generated)
├── cli.ts / index.ts        # CLI entry
└── package.json
```

- **Source components live in `registry/<framework>/ui`**
- **The CLI installs from JSON registry files in `public/r`**, generated by `registry:build`.

---

## Prerequisites

- Node.js LTS (18+ recommended)
- pnpm / npm / yarn (any supported by the project)
- Git

---

## Local Setup

```bash
# 1. Fork & clone
git clone https://github.com/nerdboi008/clipmotion.git
cd clipmotion

# 2. Install dependencies
npm install
# or
pnpm install
# or
yarn install

# 3. Link CLI locally
npm link
# now you can run:
clipmotion --help
```

This installs:

- CLI dependencies (commander, chalk, ora, etc.)
- Component dependencies (next, react, vue, etc.) as **devDependencies**

**Note:** These dev dependencies are NOT included in the published CLI package. They're only used for:

- Type checking registry components
- IDE autocomplete
- Development experience

When users run `clipmotion add`, dependencies are installed fresh in their project from the registry JSON metadata.

---

## Adding a New Component (Recommended Flow)

The easiest way to contribute is to add a new animation component based on a video.

### Config Structure

When you run `clipmotion init`, it creates a config with paths optimized to avoid conflicts:

```json
{
  "framework": "nextjs",
  "aliases": {
    "components": "components",
    "utils": "components/utils" // Inside components to avoid lib/utils conflicts
  }
}
```

**Why utils inside components?**  
Many projects already have `lib/utils` or `src/lib/utils` files. Placing ClipMotion utilities inside the components folder prevents accidental overwrites.

### Framework Support

When creating components:

1. **Start with one framework** (usually Next.js or React)
2. **Add others gradually** as needed
3. **Use the framework flag** to test:

```bash
# Test Next.js version
clipmotion add your-component --framework=nextjs --local

# Test React version
clipmotion add your-component --framework=react --local
```

Components don't need to be available for all frameworks - users can override!

### 1. Use the `create` command

```bash
clipmotion create <component-name>
# example:
clipmotion create blur-image-toggle
```

The CLI will ask you for:

- Framework (Next.js, React, Vue, Angular)
- Source video URL (Instagram / TikTok / YouTube, etc.)
- Description
- Category
- Difficulty (easy / medium / hard)

It will scaffold:

```txt
registry/<framework>/
├── ui/<component-name>.tsx/.vue    # Component stub
├── examples/<component-name>.tsx   # Example usage
└── <component-name>.README.md      # Docs stub
```

#### Adding Your Credit

When creating components, add your information to get credited:

```tsx
/**
 * @description Your component description
 * @category Component Category
 * @source https://instagram.com/p/your-video
 * @author Your Name
 * @github https://github.com/yourusername
 * @x https://x.com/yourusername  (optional)
 * @website https://yourwebsite.com  (optional)
 */
```

Your name will appear:

- When users install your component
- In `clipmotion credits` command
- On the ClipMotion website (coming soon!)

#### Why Add Credits?

- Get recognition for your work
- Drive traffic to your GitHub/social profiles
- Build your open source portfolio
- Grow your network in the dev community

### 2. Implement the animation

- Open the generated component in `registry/<framework>/ui/<component-name>.*`
- Implement the actual animation based on the video
- Keep it:
  - **Framework-idiomatic**
  - **Performant**
  - **Accessible (focus states, reduced motion where relevant)**

### 3. Run & test locally

If you have example playgrounds configured (like test Next.js app), use them (adjust command to your setup):

```bash
# Example: run dev and open the example
npm run dev
# or run whatever dev script the repo uses for examples
```

Make sure:

- No TypeScript errors
- No runtime errors
- Works on different viewport sizes
- Animations feel smooth

### 4. Build the registry

```bash
clipmotion registry:build
# or via npm script, if set:
npm run registry:build
```

This:

- Scans `registry/`
- Generates JSON files under `public/r/<framework>/*.json`
- Creates/updates `public/r/index.json` for the `find` command

### 5. Try installing your component via CLI

In a **separate test project**:

```bash
clipmotion init
clipmotion add <component-name>
```

Verify the component:

- Installs in the expected path (`clipmotion-components.json` aliases)
- Compiles and runs
- Has correct dependencies

---

## Branching Policy

### Branch Naming Conventions

To keep the development process organized and make it easy for maintainers to understand the scope of a pull request at a glance, we follow a strict branch naming convention.

**Format:** `category/short-description`

Please use the following prefixes when creating a new branch:

| Category | Prefix | Description | Example |
| --- | --- | --- | --- |
| **New UI Component** | `ui/` | For creating a brand new UI component. | `ui/navbar-main` |
| **Update UI** | `ui-upd/` | Updating or enhancing an existing UI component. | `ui-upd/button-variants` |
| **Bug Fix** | `fix/` | Fixing a bug or an issue. | `fix/header-overlap` |
| **New Feature** | `feat/` | New functional logic (non-UI specific). | `feat/auth-integration` |
| **Refactor** | `refactor/` | Code changes that neither fix a bug nor add a feature. | `refactor/api-calls` |
| **Performance** | `perf/` | Changes aimed at improving performance. | `perf/image-loading` |
| **Documentation** | `docs/` | Updates to the documentation or README. | `docs/setup-guide` |
| **Maintenance** | `chore/` | Updating dependencies, build scripts, or config. | `chore/update-deps` |

#### Guidelines

1. **Lowercase only:** Use lowercase letters, numbers, and hyphens.
2. **Kebab-case:** Use hyphens `-` to separate words in the description (e.g., `sidebar-menu`, not `sidebar_menu` or `sidebarMenu`).
3. **Be Concise:** Keep the description short but descriptive.
4. **Link Issues:** If the branch is related to a specific GitHub issue, it is helpful (but optional) to include the issue number: `fix/124-login-crash`.

---

### Questions?

If you're unsure which branch type to use, feel free to ask in the issue or discussion thread before creating your branch.

## Testing Guidelines

All contributions must include appropriate tests.

### Test Structure

```text
tests/
├── unit/              # Unit tests for individual functions
├── e2e/               # End-to-end CLI tests
└── registry/          # Registy integrity tests 
```

### Writing Tests

1. **Unit Tests**: Test individual functions in isolation

   ```tsx
   describe("toKebabCase", () => {
     it("converts to kebab-case", () => {
       expect(toKebabCase("Hello World")).toBe("hello-world");
     });
   });
   ```

2. **E2E Tests**: Test actual CLI execution

   ```tsx
   it('runs init command successfully', async () => {
     const { exitCode, stdout } = await execa('clipmotion', ['init', '--framework', 'react']);
     expect(exitCode).toBe(0);
   });
   ```

### Running Tests Before PR

```bash
# Run all tests
npm test

npm run lint

# Build to verify compilation
npm run build
```

### Test Coverage Requirements

- **Minimum**: 70% overall coverage
- **Critical paths**: 90% coverage (init, add, create commands)
- Coverage reports are generated automatically in CI

### Mock Guidelines

- Mock external dependencies (ora, chalk, execa)
- Mock file system operations when testing in isolation
- Mock `process.exit` to prevent test suite termination

## Mapping Video → Component (Registry / find Command)

The `find` command relies on registry metadata (like `index.json`).  
If you maintain a mapping of video URLs to components, please:

- Add/update the relevant entry in the registry index (or a `registry.json` if one exists)
- Include:
  - `id` (component name)
  - `name`
  - `description`
  - `sources` (array of video URLs)
  - `libraries` (frameworks supported)
  - `difficulty`, `tags`, etc.

This allows:

```bash
clipmotion find https://www.instagram.com/p/XXXXX/
```

to point to your new component and let users install it easily.

---

## Working on the CLI Itself

You can also contribute to commands:

- `init` – project config detection, aliases, registry URL
- `add` – install components & dependencies
- `find` – map video URLs to registry entries
- `create` – scaffolding for contributors
- `registry:build` – building JSON from source files

Guidelines:

- Keep UX simple and clear
- Handle errors gracefully
- Support `--debug` for more verbose logging
- Avoid breaking existing flags without a good reason

---

## Coding & Style Guidelines

- Use TypeScript where possible
- Keep functions small and focused
- Prefer pure functions for parsing / transformations
- Add types/interfaces for shared structures (`RegistryItem`, `ComponentConfig`, etc.)
- Use consistent naming:
  - Files in `ui/` → kebab-case (e.g., `blur-image-toggle.tsx`)
  - Components → PascalCase (e.g., `BlurImageToggle`)

---

## Commit & PR Process

1. **Create a branch**:

```bash
git checkout -b feat/blur-image-toggle
```

2. **Commit with a clear message**:

```bash
git commit -m "feat: add blur image toggle animation for nextjs"
```

3. **Push and open PR**:

- Push to your fork
- Open a pull request to the main repo
- In the PR description:
  - Link the source video
  - Explain what the component does
  - Mention which framework(s) you implemented
  - Add screenshots or GIFs if possible

---

## PR Checklist

Before submitting:

- [ ] Code compiles without errors
- [ ] `clipmotion registry:build` succeeds
- [ ] New component works via `clipmotion add <name>`
- [ ] No obvious performance issues
- [ ] No unused imports or dead code
- [ ] Documentation (`README` or comments) is updated
- [ ] Component name is clear and consistent

---

## Questions / Ideas

If you have:

- A new idea for a command (`clipmotion something`)
- A suggestion for how to better structure the registry
- Thoughts on supporting more libraries (GSAP, Three.js, WebGL, etc.)

Open:

- A **GitHub Discussion** for brainstorming, or
- A **GitHub Issue** if it’s concrete and actionable

---

Thanks again for contributing to ClipMotion.  
You’re helping turn the coolest animations from the internet into reusable building blocks for everyone.
